{"ast":null,"code":"var _jsxFileName = \"/Users/onesmusnyakotyo/earnedit/frontend/src/screens/CheckoutScreen/StripeCheckout.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { useStripe } from '@stripe/react-stripe-js';\nimport { useSelector } from 'react-redux';\nimport { fetchFromAPI } from './StripeHelper';\nimport { Button, Form } from 'react-bootstrap';\nimport Loader from '../../components/Loader';\nimport Message from '../../components/Message';\nimport FormContainer from '../../components/FormContainer'; //import { LinkContainer } from 'react-router-bootstrap'\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst StripeCheckout = () => {\n  _s();\n\n  const [email, setEmail] = useState('');\n  const order = useSelector(state => state.order); //   Calculate prices\n\n  const addDecimals = num => {\n    return (Math.round(num * 100) / 100).toFixed(2);\n  };\n\n  order.shippingAmount = addDecimals(order.sendAmount.fromAmount * 0.10, 0);\n  order.totalAmount = (Number(order.sendAmount.fromAmount) + Number(order.shippingAmount)).toFixed(2);\n  const transactionTotals = [];\n  console.log('Totals', transactionTotals);\n  transactionTotals.push(order.totalAmount);\n  const userLogin = useSelector(state => state.userLogin);\n  const {\n    loading,\n    error,\n    userInfo\n  } = userLogin;\n  const stripe = useStripe();\n\n  const checkoutHandler = async e => {\n    e.preventDefault();\n    const line_items = transactionTotals.map(item => {\n      return {\n        quantity: 1,\n        price_data: {\n          currency: 'usd',\n          unit_amount: item * 100,\n          //in cents\n          product_data: {\n            name: 'Money transfer',\n            description: 'Money will be transfered immediately and ready for collection' //images: [item.imageUrl]\n\n          }\n        }\n      };\n    });\n    const response = await fetchFromAPI('create-checkout-session', {\n      body: {\n        line_items,\n        customer_email: email\n      }\n    });\n    console.log('RESPONSE', response);\n    const {\n      sessionId\n    } = response;\n    const {\n      error\n    } = await stripe.redirectToCheckout({\n      sessionId\n    });\n\n    if (error) {\n      console.log(error);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(FormContainer, {\n      children: [error && /*#__PURE__*/_jsxDEV(Message, {\n        variant: \"danger\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 26\n      }, this), loading && /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 28\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"text-center py-3 m-3\",\n        children: \"Please Checkout Below\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Form, {\n        onSubmit: checkoutHandler,\n        children: /*#__PURE__*/_jsxDEV(Form.Group, {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(Form.Control, {\n            type: \"email\",\n            placeholder: \"Email\",\n            value: email,\n            required: true,\n            onChange: e => setEmail(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 99,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 106,\n            columnNumber: 21\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            variant: \"primary\",\n            children: \"Checkout\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 21\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n\n_s(StripeCheckout, \"vHWIf3rbakChWKlm0BYTH2o8UuY=\", false, function () {\n  return [useSelector, useSelector, useStripe];\n});\n\n_c = StripeCheckout;\nexport default StripeCheckout;\n\nvar _c;\n\n$RefreshReg$(_c, \"StripeCheckout\");","map":{"version":3,"sources":["/Users/onesmusnyakotyo/earnedit/frontend/src/screens/CheckoutScreen/StripeCheckout.js"],"names":["React","useState","useStripe","useSelector","fetchFromAPI","Button","Form","Loader","Message","FormContainer","StripeCheckout","email","setEmail","order","state","addDecimals","num","Math","round","toFixed","shippingAmount","sendAmount","fromAmount","totalAmount","Number","transactionTotals","console","log","push","userLogin","loading","error","userInfo","stripe","checkoutHandler","e","preventDefault","line_items","map","item","quantity","price_data","currency","unit_amount","product_data","name","description","response","body","customer_email","sessionId","redirectToCheckout","target","value"],"mappings":"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","sourcesContent":["import React, {useState} from 'react'\nimport { useStripe } from '@stripe/react-stripe-js'\nimport { useSelector } from 'react-redux'\nimport { fetchFromAPI }  from './StripeHelper'\nimport {Button, Form } from 'react-bootstrap'\nimport Loader from '../../components/Loader'\nimport Message from '../../components/Message'\nimport FormContainer from '../../components/FormContainer'\n//import { LinkContainer } from 'react-router-bootstrap'\n\n\nconst StripeCheckout = () => {\n\n    const [email, setEmail] = useState('')\n\n    const order  = useSelector((state) => state.order)\n\n\n   //   Calculate prices\n  const addDecimals = (num) => {\n    return (Math.round(num * 100) / 100).toFixed(2)\n  }\n\n\n    order.shippingAmount = addDecimals(order.sendAmount.fromAmount * 0.10, 0)\n\n  order.totalAmount = (\n    Number(order.sendAmount.fromAmount) +\n    Number(order.shippingAmount )\n    ).toFixed(2)\n\n    const transactionTotals = []\n\n    console.log('Totals', transactionTotals)\n\n    transactionTotals.push(order.totalAmount)\n\n\n    const userLogin = useSelector(state => state.userLogin)\n\n\n    const { loading, error, userInfo} = userLogin\n\n    const stripe = useStripe()\n\n    const checkoutHandler = async (e) => {\n        e.preventDefault()\n        const line_items = transactionTotals.map(item => {\n         \n            return {\n                quantity: 1,\n                price_data: {\n                    currency:'usd',\n                    unit_amount: item * 100, //in cents\n                    product_data: {\n                        name: 'Money transfer',\n                        description: 'Money will be transfered immediately and ready for collection',\n                        //images: [item.imageUrl]\n                    }\n                }\n            }\n        })\n\n        const response = await fetchFromAPI('create-checkout-session', {\n            body: { line_items, customer_email: email}\n\n        })\n\n        console.log('RESPONSE',response)\n\n        const { sessionId } = response;\n\n      \n\n        const { error } = await stripe.redirectToCheckout({\n            sessionId\n        })\n\n        if(error){\n            console.log(error)\n        }\n    }\n\n    return (\n        <>\n            <FormContainer>\n\n\n               {error && <Message variant='danger'>{error}</Message>}\n               {loading && <Loader />}\n                   \n                <h4 className='text-center py-3 m-3'>Please Checkout Below</h4>\n                 \n                     \n\n                <Form  onSubmit={checkoutHandler}> \n                <Form.Group className='text-center'>\n  \n                    <Form.Control \n                        type=\"email\" \n                        placeholder=\"Email\"  \n                        value={email}\n                        required\n                        onChange={(e) => setEmail(e.target.value)}\n                        />\n                    <br />\n    \n                    <Button type='submit' variant='primary'>\n                            Checkout\n                    </Button>\n  \n                </Form.Group>\n                </Form>  \n            </FormContainer>\n            </>\n    )\n}\n\nexport default StripeCheckout\n"]},"metadata":{},"sourceType":"module"}